<% layout("/layouts/boilerplate.ejs") %>

<style>
  /* Hides the scrollbar but allows scrolling */
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
</style>

<!-- Icon Navigation -->
<div class="relative flex items-center justify-center py-4 bg-white shadow">
  <!-- Left Arrow for Scrolling -->
  <button id="scroll-left" class="absolute left-0 ml-4 bg-white p-2 rounded-full shadow hidden sm:block">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
    </svg>
  </button>

  <!-- Categories Container (Scrollable) -->
  <div id="category-container" class="flex justify-center items-center space-x-6 sm:space-x-8 bg-white overflow-x-auto scroll-smooth no-scrollbar">
    <a href="/listings/category/Amazing Pools">
      <div class="flex-shrink-0 flex flex-col items-center">
        <i class="fa-solid fa-person-swimming"></i>
        <span class="mt-2 text-xs sm:text-sm">Amazing pool</span>
      </div>
    </a>
    <a href="/listings/category/Camping">
      <div class="flex-shrink-0 flex flex-col items-center">
        <i class="fa-solid fa-fire"></i>
        <span class="mt-2 text-xs sm:text-sm">Camping</span>
      </div>
    </a>
    <a href="/listings/category/Lake Front">
      <div class="flex-shrink-0 flex flex-col items-center">
        <i class="fa-solid fa-water"></i>
        <span class="mt-2 text-xs sm:text-sm">Lake Front</span>
      </div>
    </a>
    <a href="/listings/category/Farms">
      <div class="flex-shrink-0 flex flex-col items-center">
        <i class="fa-solid fa-wheat-awn"></i>
        <span class="mt-2 text-xs sm:text-sm">Farms</span>
      </div>
    </a>
    <a href="/listings/category/Beach Front">
      <div class="flex-shrink-0 flex flex-col items-center">
        <i class="fa-solid fa-umbrella-beach"></i>        
        <span class="mt-2 text-xs sm:text-sm">Beach Front</span>
      </div>
    </a>
    <a href="/listings/category/Mountain">
      <div class="flex-shrink-0 flex flex-col items-center">
        <i class="fa-solid fa-mountain"></i>
        <span class="mt-2 text-xs sm:text-sm">Mountain</span>
      </div>
    </a>
    <a href="/listings/category/Desert">
      <div class="flex-shrink-0 flex flex-col items-center">
        <i class="fa-solid fa-hippo"></i>
        <span class="mt-2 text-xs sm:text-sm">Desert</span>
      </div>
    </a>
    <a href="/listings/category/Country Side">
      <div class="flex-shrink-0 flex flex-col items-center">
        <i class="fa-solid fa-globe"></i>
        <span class="mt-2 text-xs sm:text-sm">Countryside</span>
      </div>
    </a>
    <a href="/listings/category/Forest">
      <div class="flex-shrink-0 flex flex-col items-center">
        <i class="fa-solid fa-tree"></i>
        <span class="mt-2 text-xs sm:text-sm">Forest</span>
      </div>
    </a>
    <a href="/listings/category/Vineyard">
      <div class="flex-shrink-0 flex flex-col items-center">
        <i class="fa-solid fa-wine-glass"></i>
        <span class="mt-2 text-xs sm:text-sm">Vineyard</span>
      </div>
    </a>
    <a href="/listings/category/Historic">
      <div class="flex-shrink-0 flex flex-col items-center">
        <i class="fa-solid fa-monument"></i>
        <span class="mt-2 text-xs sm:text-sm">Historic</span>
      </div>
    </a>
    <a href="/listings/category/Modern">
      <div class="flex-shrink-0 flex flex-col items-center">
        <i class="fa-solid fa-chart-simple"></i>
        <span class="mt-2 text-xs sm:text-sm">Modern</span>
      </div>
    </a>
    <a href="/listings/category/Luxury">
      <div class="flex-shrink-0 flex flex-col items-center">
        <i class="fa-solid fa-money-bill-wave"></i>
        <span class="mt-2 text-xs sm:text-sm">Luxury</span>
      </div>
    </a>
    <a href="/listings/category/Budget">
      <div class="flex-shrink-0 flex flex-col items-center">
        <i class="fa-solid fa-wallet"></i>
        <span class="mt-2 text-xs sm:text-sm">Budget</span>
      </div>
    </a>
    <a href="/listings/category/Urban">
      <div class="flex-shrink-0 flex flex-col items-center">
        <i class="fa-solid fa-city"></i>
        <span class="mt-2 text-xs sm:text-sm">Urban</span>
      </div>
    </a>
  </div>

  <!-- Right Arrow for Scrolling -->
  <button id="scroll-right" class="absolute right-0 mr-4 bg-white p-2 rounded-full shadow hidden sm:block">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
    </svg>
  </button>
</div>

<!-- Main Content: Listings -->
<div class="w-[90%] max-w-7xl mx-auto py-8">
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-12">
    <% for(let listing of allListing) { %>
      <!-- Dynamic Card -->
      <a href="/listings/<%= listing._id %>" class="block">
        <div class="bg-white shadow-lg rounded-lg overflow-hidden flex flex-col">
          <!-- Dynamic Image -->
          <img src="<%= listing.image.url %>" alt="<%= listing.title %>" class="w-full h-56 sm:h-64 object-cover">
          
          <!-- Dynamic Title and Price -->
          <div class="p-3 flex-grow">
            <h2 class="text-lg sm:text-xl font-semibold text-black"><%= listing.title %></h2>
            <h2 class="font-semibold">&#8377;<%= listing.price.toLocaleString("en-IN") %></h2>
          </div>
        </div>
      </a>
    <% } %>
  </div>
</div>

<!-- Add JavaScript to handle scrolling -->
<script>
  const container = document.getElementById('category-container');
  const scrollLeftButton = document.getElementById('scroll-left');
  const scrollRightButton = document.getElementById('scroll-right');

  // Show or hide the arrow buttons based on scroll position
  function updateArrows() {
    if (container.scrollLeft === 0) {
      scrollLeftButton.classList.add('hidden');
    } else {
      scrollLeftButton.classList.remove('hidden');
    }
    if (container.scrollLeft + container.clientWidth >= container.scrollWidth) {
      scrollRightButton.classList.add('hidden');
    } else {
      scrollRightButton.classList.remove('hidden');
    }
  }

  scrollLeftButton.addEventListener('click', () => {
    container.scrollBy({ left: -300, behavior: 'smooth' });
  });

  scrollRightButton.addEventListener('click', () => {
    container.scrollBy({ left: 300, behavior: 'smooth' });
  });

  // Call updateArrows on scroll
  container.addEventListener('scroll', updateArrows);

  // Initial check on page load
  updateArrows();
</script>
